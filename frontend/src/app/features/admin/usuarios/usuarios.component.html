<section class="container mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">Gesti√≥n de usuarios</h1>

  <div *ngIf="isLoading">Cargando usuarios...</div>
  <div *ngIf="errorMessage" class="text-red-600 mb-2">{{ errorMessage }}</div>

  <table
    *ngIf="usuarios$ | async as usuarios"
    class="min-w-full border border-gray-300 mt-4 text-sm"
  >
    <thead>
      <tr class="bg-gray-100">
        <th class="border px-2 py-1 text-left">Nombre</th>
        <th class="border px-2 py-1 text-left">Correo</th>
        <th class="border px-2 py-1 text-left">Carrera</th>
        <th class="border px-2 py-1 text-left">Semestre</th>
        <th class="border px-2 py-1 text-left">Rol</th>
        <th class="border px-2 py-1 text-left">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let u of usuarios">
        <td class="border px-2 py-1">
          {{ u.nombre || '-' }} {{ u.apellido || '' }}
        </td>
        <td class="border px-2 py-1">{{ u.email }}</td>
        <td class="border px-2 py-1">{{ u.carrera || '-' }}</td>
        <td class="border px-2 py-1">{{ u.semestre || '-' }}</td>
        <td class="border px-2 py-1 capitalize">{{ u.role || 'invitado' }}</td>
        <td class="border px-2 py-1">
          <select
            [ngModel]="u.role"
            (ngModelChange)="actualizarRol(u.uid, $event)"
            class="border px-1 py-0.5 text-xs"
          >
            <option value="estudiante">Estudiante</option>
            <option value="profesor">Profesor</option>
            <option value="administrador">Administrador</option>
            <option value="invitado">Invitado</option>
          </select>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="usuarios$ | async as usuarios">
    <p class="mt-2 text-xs text-gray-500">
      Total usuarios: {{ usuarios.length }}
    </p>
  </div>
</section>
